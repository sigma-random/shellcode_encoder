



/*
test on win xp / win7
*/
char msgbox_shellcode[] = 
"\x31\xd2\xb2\x30\x64\x8b\x12\x8b\x52\x0c\x8b\x52\x1c\x8b\x42"
"\x08\x8b\x72\x20\x8b\x12\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03"
"\x78\x3c\x8b\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x31\xed\x8b"
"\x34\xaf\x01\xc6\x45\x81\x3e\x46\x61\x74\x61\x75\xf2\x81\x7e"
"\x08\x45\x78\x69\x74\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c"
"\x6f\x8b\x7a\x1c\x01\xc7\x8b\x7c\xaf\xfc\x01\xc7\x68\x79\x74"
"\x65\x01\x68\x6b\x65\x6e\x42\x68\x20\x42\x72\x6f\x89\xe1\xfe"
"\x49\x0b\x31\xc0\x51\x50\xff\xd7";



/*

just work on win7 x64 
*/
char ascii_encode_msgbox_shellcode[] = \
"\x54\x58\x2d\x4a\x57\x5b\x59\x2d\x3d\x52\x52\x52\x2d\x54\x54\x52"
"\x54\x50\x5c\x25\x3b\x53\x5e\x36\x25\x40\x24\x21\x40\x2d\x29\x6f"
"\x6f\x6f\x50\x2d\x6b\x6f\x6b\x30\x2d\x5a\x68\x6a\x30\x2d\x52\x67"
"\x6a\x30\x50\x2d\x40\x5f\x6c\x49\x2d\x3f\x55\x67\x3d\x2d\x43\x53"
"\x71\x47\x50\x2d\x47\x71\x41\x2a\x2d\x45\x69\x40\x25\x50\x2d\x68"
"\x58\x22\x3a\x2d\x5e\x53\x22\x34\x2d\x6a\x5b\x24\x31\x50\x2d\x6d"
"\x7e\x5f\x6a\x2d\x6d\x7e\x5b\x69\x50\x2d\x51\x58\x5d\x24\x2d\x4f"
"\x52\x4e\x24\x2d\x4f\x4c\x54\x24\x50\x2d\x43\x3f\x51\x4c\x2d\x3a"
"\x33\x4d\x4c\x50\x2d\x67\x28\x6e\x41\x2d\x62\x27\x6b\x37\x2d\x6c"
"\x26\x71\x40\x50\x2d\x69\x60\x77\x3d\x2d\x62\x52\x72\x39\x2d\x71"
"\x5e\x76\x37\x50\x2d\x63\x58\x4f\x31\x2d\x57\x46\x4e\x30\x2d\x6b"
"\x50\x52\x30\x50\x2d\x61\x22\x68\x39\x2d\x48\x22\x63\x34\x2d\x43"
"\x22\x60\x3a\x50\x2d\x59\x3c\x67\x68\x2d\x57\x39\x52\x67\x2d\x56"
"\x39\x5e\x6b\x50\x2d\x6c\x30\x71\x22\x50\x2d\x49\x2a\x7c\x75\x2d"
"\x4a\x28\x7a\x75\x50\x2d\x69\x31\x69\x5e\x2d\x63\x2e\x55\x5e\x2d"
"\x63\x31\x4f\x60\x50\x2d\x2b\x62\x58\x64\x2d\x2a\x5e\x50\x5a\x2d"
"\x2b\x5b\x4a\x64\x50\x2d\x69\x5c\x48\x69\x2d\x5f\x58\x41\x60\x2d"
"\x73\x5c\x48\x73\x50\x2d\x34\x24\x2c\x5e\x2d\x2c\x24\x29\x5c\x2d"
"\x2a\x25\x28\x5a\x50\x2d\x6b\x73\x3d\x4c\x2d\x68\x63\x3c\x43\x2d"
"\x6c\x64\x3d\x3d\x50\x2d\x67\x68\x55\x60\x2d\x61\x62\x54\x5d\x2d"
"\x6f\x69\x58\x61\x50\x2d\x46\x72\x5d\x43\x2d\x40\x71\x4e\x33\x2d"
"\x3e\x70\x54\x4e\x50\x2d\x4b\x50\x46\x5b\x2d\x49\x3e\x3f\x57\x50"
"\x2d\x60\x53\x27\x2b\x2d\x5d\x50\x24\x29\x2d\x64\x51\x28\x29\x50"
"\x2d\x2d\x5d\x77\x2b\x2d\x27\x58\x70\x29\x2d\x33\x58\x76\x2c\x50"
"\x2d\x3f\x73\x6e\x4d\x2d\x30\x74\x6f\x35\x50\x2d\x6b\x42\x5b\x66"
"\x2d\x5f\x3c\x5c\x4f\x50\x2d\x77\x40\x3c\x63\x2d\x77\x40\x3c\x64"
"\x50\x2d\x6a\x3e\x75\x73\x2d\x60\x37\x75\x72\x2d\x69\x43\x75\x74"
"\x50";

int main(){

	__asm{
		
		//lea eax,msgbox_shellcode
		lea eax,ascii_encode_msgbox_shellcode
		mov esp,eax				
		jmp eax			//if using call eax,will fail
		ret
	
	}




}