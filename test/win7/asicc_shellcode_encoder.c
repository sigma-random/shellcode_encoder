



/*
test on win xp / win7
*/

char msgbox_shellcode[] = 
"\x31\xd2\xb2\x30\x64\x8b\x12\x8b\x52\x0c\x8b\x52\x1c\x8b\x42"
"\x08\x8b\x72\x20\x8b\x12\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03"
"\x78\x3c\x8b\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x31\xed\x8b"
"\x34\xaf\x01\xc6\x45\x81\x3e\x46\x61\x74\x61\x75\xf2\x81\x7e"
"\x08\x45\x78\x69\x74\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c"
"\x6f\x8b\x7a\x1c\x01\xc7\x8b\x7c\xaf\xfc\x01\xc7"
"\x68\x72\x6c\x64\x01"
"\x68\x6f\x20\x57\x6f"
"\x68\x48\x65\x6c\x6c"
"\x89\xe1\xfe\x49\x0b\x31\xc0\x51\x50\xff\xd7";

/*

just work on win7 x64 
*/
char ascii_encode_msgbox_shellcode[] = \
"\x54\x58\x2d\x4e\x59\x5a\x55\x2d\x39\x4f\x54\x54\x2d\x4f\x55\x51"
"\x56\x50\x5c\x25\x29\x35\x48\x4f\x25\x40\x40\x21\x30\x2d\x29\x6f"
"\x6f\x6f\x50\x2d\x60\x72\x70\x30\x2d\x5d\x66\x6a\x2c\x2d\x5a\x66"
"\x65\x34\x50\x2d\x42\x65\x70\x49\x2d\x34\x56\x6a\x40\x2d\x4c\x4c"
"\x6a\x44\x50\x2d\x4e\x70\x4d\x28\x2d\x44\x6d\x34\x27\x50\x2d\x55"
"\x59\x6d\x29\x2d\x54\x49\x67\x28\x2d\x54\x61\x6c\x2a\x50\x2d\x66"
"\x59\x62\x59\x2d\x55\x48\x61\x50\x2d\x4c\x57\x64\x64\x50\x2d\x56"
"\x5c\x3e\x72\x2d\x45\x52\x37\x70\x2d\x5b\x54\x46\x73\x50\x2d\x3d"
"\x36\x5a\x4f\x2d\x39\x34\x43\x49\x50\x2d\x67\x27\x72\x41\x2d\x60"
"\x26\x6d\x36\x2d\x6e\x28\x6b\x41\x50\x2d\x6a\x65\x75\x3c\x2d\x69"
"\x55\x74\x33\x2d\x69\x56\x76\x3e\x50\x2d\x64\x59\x4f\x32\x2d\x58"
"\x44\x4a\x2e\x2d\x69\x51\x56\x31\x50\x2d\x50\x22\x6b\x37\x2d\x48"
"\x22\x63\x33\x2d\x54\x22\x5d\x3d\x50\x2d\x58\x3f\x60\x6a\x2d\x57"
"\x38\x56\x63\x2d\x57\x37\x61\x6d\x50\x2d\x6c\x30\x71\x22\x50\x2d"
"\x4c\x2b\x7b\x78\x2d\x47\x27\x7b\x72\x50\x2d\x6d\x30\x5b\x61\x2d"
"\x65\x2d\x4d\x5e\x2d\x5d\x33\x65\x5d\x50\x2d\x2a\x60\x60\x67\x2d"
"\x28\x5b\x3e\x5f\x2d\x2e\x60\x54\x5c\x50\x2d\x70\x5f\x52\x6c\x2d"
"\x64\x58\x43\x69\x2d\x67\x59\x3c\x67\x50\x2d\x31\x24\x29\x5e\x2d"
"\x29\x24\x28\x59\x2d\x30\x25\x2c\x5d\x50\x2d\x6a\x6c\x3f\x51\x2d"
"\x6a\x66\x3c\x42\x2d\x6b\x68\x3b\x39\x50\x2d\x67\x66\x58\x62\x2d"
"\x5d\x5d\x4f\x57\x2d\x73\x70\x5a\x65\x50\x2d\x42\x72\x57\x46\x2d"
"\x3a\x6e\x53\x41\x2d\x48\x73\x55\x3d\x50\x2d\x4c\x4b\x42\x5b\x2d"
"\x48\x43\x43\x57\x50\x2d\x65\x51\x27\x29\x2d\x5d\x4f\x26\x28\x2d"
"\x5f\x54\x26\x2c\x50\x2d\x2d\x61\x74\x2c\x2d\x2c\x4d\x74\x29\x2d"
"\x2e\x5f\x75\x2b\x50\x2d\x37\x73\x71\x41\x2d\x38\x74\x6c\x41\x50"
"\x2d\x69\x40\x5b\x5a\x2d\x61\x3e\x5c\x5b\x50\x2d\x78\x41\x3f\x6b"
"\x2d\x76\x3f\x39\x5c\x50\x2d\x67\x49\x76\x74\x2d\x64\x3c\x73\x71"
"\x2d\x68\x33\x76\x74\x50";

/*
TX-J]YW-CTTT-ILRTP\%AFEU%"!""-)oooP-]jn0-\hi,-^lh4P-CXsD-@WgB-?XjGP-RqC'-@l>(P-Ycm)-OUi)-UKj)P-gWc\-VQ[X-JPiYP-WV>t-RV>o-MV?rP-@9US-61HEP-k'nF-_'m<-k'o6P-kbu:-hOu8-i_u;P-aPS0-XOM0-lOO1P-Q"c7-H"b4-S"f<P-X=ih-V8Xh-X9VjP-l0q"P-J)|v-I)ztP-e1Yd-a.PZ-i1d^P-+iUb-)^=_-,T`aP-i\Kl-iZDi-iZBgP-.$)\-,#)V-0&+bP-li<F-hg78-kjCNP-nfU_-f`U_-cmW`P-BqUF-AlU6-AvUHP-JGEa-JG@QP-hR(+-XP$)-aR')P--Yv*-'Ot)-3es-P-9tpD-6sm>P-hC\]-b;[XP-zDDc-t<4dP-f?us-d=us-i<usP
*/
char asicc[] = "TX-J]YW-CTTT-ILRTP\\%AFEU%\"!\"\"-)oooP-]jn0-\\hi,-^lh4P-CXsD-@WgB-?XjGP-RqC'-@l>(P-Ycm)-OUi)-UKj)P-gWc\\-VQ[X-JPiYP-WV>t-RV>o-MV?rP-@9US-61HEP-k'nF-_'m<-k'o6P-kbu:-hOu8-i_u;P-aPS0-XOM0-lOO1P-Q\"c7-H\"b4-S\"f<P-X=ih-V8Xh-X9VjP-l0q\"P-J)|v-I)ztP-e1Yd-a.PZ-i1d^P-+iUb-)^=_-,T`aP-i\\Kl-iZDi-iZBgP-.$)\\-,#)V-0&+bP-li<F-hg78-kjCNP-nfU_-f`U_-cmW`P-BqUF-AlU6-AvUHP-JGEa-JG@QP-hR(+-XP$)-aR')P--Yv*-'Ot)-3es-P-9tpD-6sm>P-hC\\]-b;[XP-zDDc-t<4dP-f?us-d=us-i<usP";

int main(){

	__asm{
		//lea eax,msgbox_shellcode
		//lea eax,ascii_encode_msgbox_shellcode
		lea eax,asicc
		mov esp,eax				
		jmp eax			//if using call eax,will fail
		ret
	
	}




}